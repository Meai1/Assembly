#include <stdio.h>
#include <stdlib.h>
/*

Converts ascii to ebcdic and back.

#define STRING_SIZE 100000
#define ITERATIONS 100000

real    1m2.915s
user    1m2.883s
sys     0m0.002s

*/

#define STRING_SIZE 100000
#define ITERATIONS 100000

unsigned char ascii[STRING_SIZE];
unsigned char ebcdic[STRING_SIZE];

unsigned char to_ascii[256];
unsigned char to_ebcdic[256];

void
load_tables()
{
/* to ebcdic */
to_ebcdic[0x00]=0x00;
to_ebcdic[0x01]=0x01;
to_ebcdic[0x02]=0x02;
to_ebcdic[0x03]=0x03;
to_ebcdic[0x04]=0x37;
to_ebcdic[0x05]=0x2D;
to_ebcdic[0x06]=0x2E;
to_ebcdic[0x07]=0x2F;
to_ebcdic[0x08]=0x16;
to_ebcdic[0x09]=0x05;
to_ebcdic[0x0A]=0x25;
to_ebcdic[0x0B]=0x0B;
to_ebcdic[0x0C]=0x0C;
to_ebcdic[0x0D]=0x0D;
to_ebcdic[0x0E]=0x0E;
to_ebcdic[0x0F]=0x0F;
to_ebcdic[0x10]=0x10;
to_ebcdic[0x11]=0x11;
to_ebcdic[0x12]=0x12;
to_ebcdic[0x13]=0x13;
to_ebcdic[0x14]=0x3C;
to_ebcdic[0x15]=0x3D;
to_ebcdic[0x16]=0x32;
to_ebcdic[0x17]=0x26;
to_ebcdic[0x18]=0x18;
to_ebcdic[0x19]=0x19;
to_ebcdic[0x1A]=0x3F;
to_ebcdic[0x1B]=0x27;
to_ebcdic[0x1C]=0x1C;
to_ebcdic[0x1D]=0x1D;
to_ebcdic[0x1E]=0x1E;
to_ebcdic[0x1F]=0x1F;
to_ebcdic[0x20]=0x40;
to_ebcdic[0x21]=0x4F;
to_ebcdic[0x22]=0x7F;
to_ebcdic[0x23]=0x7B;
to_ebcdic[0x24]=0x5B;
to_ebcdic[0x25]=0x6C;
to_ebcdic[0x26]=0x50;
to_ebcdic[0x27]=0x7D;
to_ebcdic[0x28]=0x4D;
to_ebcdic[0x29]=0x5D;
to_ebcdic[0x2A]=0x5C;
to_ebcdic[0x2B]=0x4E;
to_ebcdic[0x2C]=0x6B;
to_ebcdic[0x2D]=0x60;
to_ebcdic[0x2E]=0x4B;
to_ebcdic[0x2F]=0x61;
to_ebcdic[0x30]=0xF0;
to_ebcdic[0x31]=0xF1;
to_ebcdic[0x32]=0xF2;
to_ebcdic[0x33]=0xF3;
to_ebcdic[0x34]=0xF4;
to_ebcdic[0x35]=0xF5;
to_ebcdic[0x36]=0xF6;
to_ebcdic[0x37]=0xF7;
to_ebcdic[0x38]=0xF8;
to_ebcdic[0x39]=0xF9;
to_ebcdic[0x3A]=0x7A;
to_ebcdic[0x3B]=0x5E;
to_ebcdic[0x3C]=0x4C;
to_ebcdic[0x3D]=0x7E;
to_ebcdic[0x3E]=0x6E;
to_ebcdic[0x3F]=0x6F;
to_ebcdic[0x40]=0x7C;
to_ebcdic[0x41]=0xC1;
to_ebcdic[0x42]=0xC2;
to_ebcdic[0x43]=0xC3;
to_ebcdic[0x44]=0xC4;
to_ebcdic[0x45]=0xC5;
to_ebcdic[0x46]=0xC6;
to_ebcdic[0x47]=0xC7;
to_ebcdic[0x48]=0xC8;
to_ebcdic[0x49]=0xC9;
to_ebcdic[0x4A]=0xD1;
to_ebcdic[0x4B]=0xD2;
to_ebcdic[0x4C]=0xD3;
to_ebcdic[0x4D]=0xD4;
to_ebcdic[0x4E]=0xD5;
to_ebcdic[0x4F]=0xD6;
to_ebcdic[0x50]=0xD7;
to_ebcdic[0x51]=0xD8;
to_ebcdic[0x52]=0xD9;
to_ebcdic[0x53]=0xE2;
to_ebcdic[0x54]=0xE3;
to_ebcdic[0x55]=0xE4;
to_ebcdic[0x56]=0xE5;
to_ebcdic[0x57]=0xE6;
to_ebcdic[0x58]=0xE7;
to_ebcdic[0x59]=0xE8;
to_ebcdic[0x5A]=0xE9;
to_ebcdic[0x5B]=0x4A;
to_ebcdic[0x5C]=0xE0;
to_ebcdic[0x5D]=0x5A;
to_ebcdic[0x5E]=0x5F;
to_ebcdic[0x5F]=0x6D;
to_ebcdic[0x60]=0x79;
to_ebcdic[0x61]=0x81;
to_ebcdic[0x62]=0x82;
to_ebcdic[0x63]=0x83;
to_ebcdic[0x64]=0x84;
to_ebcdic[0x65]=0x85;
to_ebcdic[0x66]=0x86;
to_ebcdic[0x67]=0x87;
to_ebcdic[0x68]=0x88;
to_ebcdic[0x69]=0x89;
to_ebcdic[0x6A]=0x91;
to_ebcdic[0x6B]=0x92;
to_ebcdic[0x6C]=0x93;
to_ebcdic[0x6D]=0x94;
to_ebcdic[0x6E]=0x95;
to_ebcdic[0x6F]=0x96;
to_ebcdic[0x70]=0x97;
to_ebcdic[0x71]=0x98;
to_ebcdic[0x72]=0x99;
to_ebcdic[0x73]=0xA2;
to_ebcdic[0x74]=0xA3;
to_ebcdic[0x75]=0xA4;
to_ebcdic[0x76]=0xA5;
to_ebcdic[0x77]=0xA6;
to_ebcdic[0x78]=0xA7;
to_ebcdic[0x79]=0xA8;
to_ebcdic[0x7A]=0xA9;
to_ebcdic[0x7B]=0xC0;
to_ebcdic[0x7C]=0x6A;
to_ebcdic[0x7D]=0xD0;
to_ebcdic[0x7E]=0xA1;
to_ebcdic[0x7F]=0x07;
to_ebcdic[0x80]=0x20;
to_ebcdic[0x81]=0x21;
to_ebcdic[0x82]=0x22;
to_ebcdic[0x83]=0x23;
to_ebcdic[0x84]=0x24;
to_ebcdic[0x85]=0x15;
to_ebcdic[0x86]=0x06;
to_ebcdic[0x87]=0x17;
to_ebcdic[0x88]=0x28;
to_ebcdic[0x89]=0x29;
to_ebcdic[0x8A]=0x2A;
to_ebcdic[0x8B]=0x2B;
to_ebcdic[0x8C]=0x2C;
to_ebcdic[0x8D]=0x09;
to_ebcdic[0x8E]=0x0A;
to_ebcdic[0x8F]=0x1B;
to_ebcdic[0x90]=0x30;
to_ebcdic[0x91]=0x31;
to_ebcdic[0x92]=0x1A;
to_ebcdic[0x93]=0x33;
to_ebcdic[0x94]=0x34;
to_ebcdic[0x95]=0x35;
to_ebcdic[0x96]=0x36;
to_ebcdic[0x97]=0x08;
to_ebcdic[0x98]=0x38;
to_ebcdic[0x99]=0x39;
to_ebcdic[0x9A]=0x3A;
to_ebcdic[0x9B]=0x3B;
to_ebcdic[0x9C]=0x04;
to_ebcdic[0x9D]=0x14;
to_ebcdic[0x9E]=0x3E;
to_ebcdic[0x9F]=0xE1;
to_ebcdic[0xA0]=0x41;
to_ebcdic[0xA1]=0x42;
to_ebcdic[0xA2]=0x43;
to_ebcdic[0xA3]=0x44;
to_ebcdic[0xA4]=0x45;
to_ebcdic[0xA5]=0x46;
to_ebcdic[0xA6]=0x47;
to_ebcdic[0xA7]=0x48;
to_ebcdic[0xA8]=0x49;
to_ebcdic[0xA9]=0x51;
to_ebcdic[0xAA]=0x52;
to_ebcdic[0xAB]=0x53;
to_ebcdic[0xAC]=0x54;
to_ebcdic[0xAD]=0x55;
to_ebcdic[0xAE]=0x56;
to_ebcdic[0xAF]=0x57;
to_ebcdic[0xB0]=0x58;
to_ebcdic[0xB1]=0x59;
to_ebcdic[0xB2]=0x62;
to_ebcdic[0xB3]=0x63;
to_ebcdic[0xB4]=0x64;
to_ebcdic[0xB5]=0x65;
to_ebcdic[0xB6]=0x66;
to_ebcdic[0xB7]=0x67;
to_ebcdic[0xB8]=0x68;
to_ebcdic[0xB9]=0x69;
to_ebcdic[0xBA]=0x70;
to_ebcdic[0xBB]=0x71;
to_ebcdic[0xBC]=0x72;
to_ebcdic[0xBD]=0x73;
to_ebcdic[0xBE]=0x74;
to_ebcdic[0xBF]=0x75;
to_ebcdic[0xC0]=0x76;
to_ebcdic[0xC1]=0x77;
to_ebcdic[0xC2]=0x78;
to_ebcdic[0xC3]=0x80;
to_ebcdic[0xC4]=0x8A;
to_ebcdic[0xC5]=0x8B;
to_ebcdic[0xC6]=0x8C;
to_ebcdic[0xC7]=0x8D;
to_ebcdic[0xC8]=0x8E;
to_ebcdic[0xC9]=0x8F;
to_ebcdic[0xCA]=0x90;
to_ebcdic[0xCB]=0x9A;
to_ebcdic[0xCC]=0x9B;
to_ebcdic[0xCD]=0x9C;
to_ebcdic[0xCE]=0x9D;
to_ebcdic[0xCF]=0x9E;
to_ebcdic[0xD0]=0x9F;
to_ebcdic[0xD1]=0xA0;
to_ebcdic[0xD2]=0xAA;
to_ebcdic[0xD3]=0xAB;
to_ebcdic[0xD4]=0xAC;
to_ebcdic[0xD5]=0xAD;
to_ebcdic[0xD6]=0xAE;
to_ebcdic[0xD7]=0xAF;
to_ebcdic[0xD8]=0xB0;
to_ebcdic[0xD9]=0xB1;
to_ebcdic[0xDA]=0xB2;
to_ebcdic[0xDB]=0xB3;
to_ebcdic[0xDC]=0xB4;
to_ebcdic[0xDD]=0xB5;
to_ebcdic[0xDE]=0xB6;
to_ebcdic[0xDF]=0xB7;
to_ebcdic[0xE0]=0xB8;
to_ebcdic[0xE1]=0xB9;
to_ebcdic[0xE2]=0xBA;
to_ebcdic[0xE3]=0xBB;
to_ebcdic[0xE4]=0xBC;
to_ebcdic[0xE5]=0xBD;
to_ebcdic[0xE6]=0xBE;
to_ebcdic[0xE7]=0xBF;
to_ebcdic[0xE8]=0xCA;
to_ebcdic[0xE9]=0xCB;
to_ebcdic[0xEA]=0xCC;
to_ebcdic[0xEB]=0xCD;
to_ebcdic[0xEC]=0xCE;
to_ebcdic[0xED]=0xCF;
to_ebcdic[0xEE]=0xDA;
to_ebcdic[0xEF]=0xDB;
to_ebcdic[0xF0]=0xDC;
to_ebcdic[0xF1]=0xDD;
to_ebcdic[0xF2]=0xDE;
to_ebcdic[0xF3]=0xDF;
to_ebcdic[0xF4]=0xEA;
to_ebcdic[0xF5]=0xEB;
to_ebcdic[0xF6]=0xEC;
to_ebcdic[0xF7]=0xED;
to_ebcdic[0xF8]=0xEE;
to_ebcdic[0xF9]=0xEF;
to_ebcdic[0xFA]=0xFA;
to_ebcdic[0xFB]=0xFB;
to_ebcdic[0xFC]=0xFC;
to_ebcdic[0xFD]=0xFD;
to_ebcdic[0xFE]=0xFE;
to_ebcdic[0xFF]=0xFF;
/* to ascii */
to_ascii[0x00]=0x00;
to_ascii[0x01]=0x01;
to_ascii[0x02]=0x02;
to_ascii[0x03]=0x03;
to_ascii[0x04]=0x9C;
to_ascii[0x05]=0x09;
to_ascii[0x06]=0x86;
to_ascii[0x07]=0x7F;
to_ascii[0x08]=0x97;
to_ascii[0x09]=0x8D;
to_ascii[0x0A]=0x8E;
to_ascii[0x0B]=0x0B;
to_ascii[0x0C]=0x0C;
to_ascii[0x0D]=0x0D;
to_ascii[0x0E]=0x0E;
to_ascii[0x0F]=0x0F;
to_ascii[0x10]=0x10;
to_ascii[0x11]=0x11;
to_ascii[0x12]=0x12;
to_ascii[0x13]=0x13;
to_ascii[0x14]=0x9D;
to_ascii[0x15]=0x85;
to_ascii[0x16]=0x08;
to_ascii[0x17]=0x87;
to_ascii[0x18]=0x18;
to_ascii[0x19]=0x19;
to_ascii[0x1A]=0x92;
to_ascii[0x1B]=0x8F;
to_ascii[0x1C]=0x1C;
to_ascii[0x1D]=0x1D;
to_ascii[0x1E]=0x1E;
to_ascii[0x1F]=0x1F;
to_ascii[0x20]=0x80;
to_ascii[0x21]=0x81;
to_ascii[0x22]=0x82;
to_ascii[0x23]=0x83;
to_ascii[0x24]=0x84;
to_ascii[0x25]=0x0A;
to_ascii[0x26]=0x17;
to_ascii[0x27]=0x1B;
to_ascii[0x28]=0x88;
to_ascii[0x29]=0x89;
to_ascii[0x2A]=0x8A;
to_ascii[0x2B]=0x8B;
to_ascii[0x2C]=0x8C;
to_ascii[0x2D]=0x05;
to_ascii[0x2E]=0x06;
to_ascii[0x2F]=0x07;
to_ascii[0x30]=0x90;
to_ascii[0x31]=0x91;
to_ascii[0x32]=0x16;
to_ascii[0x33]=0x93;
to_ascii[0x34]=0x94;
to_ascii[0x35]=0x95;
to_ascii[0x36]=0x96;
to_ascii[0x37]=0x04;
to_ascii[0x38]=0x98;
to_ascii[0x39]=0x99;
to_ascii[0x3A]=0x9A;
to_ascii[0x3B]=0x9B;
to_ascii[0x3C]=0x14;
to_ascii[0x3D]=0x15;
to_ascii[0x3E]=0x9E;
to_ascii[0x3F]=0x1A;
to_ascii[0x40]=0x20;
to_ascii[0x41]=0xA0;
to_ascii[0x42]=0xA1;
to_ascii[0x43]=0xA2;
to_ascii[0x44]=0xA3;
to_ascii[0x45]=0xA4;
to_ascii[0x46]=0xA5;
to_ascii[0x47]=0xA6;
to_ascii[0x48]=0xA7;
to_ascii[0x49]=0xA8;
to_ascii[0x4A]=0x5B;
to_ascii[0x4B]=0x2E;
to_ascii[0x4C]=0x3C;
to_ascii[0x4D]=0x28;
to_ascii[0x4E]=0x2B;
to_ascii[0x4F]=0x21;
to_ascii[0x50]=0x26;
to_ascii[0x51]=0xA9;
to_ascii[0x52]=0xAA;
to_ascii[0x53]=0xAB;
to_ascii[0x54]=0xAC;
to_ascii[0x55]=0xAD;
to_ascii[0x56]=0xAE;
to_ascii[0x57]=0xAF;
to_ascii[0x58]=0xB0;
to_ascii[0x59]=0xB1;
to_ascii[0x5A]=0x5D;
to_ascii[0x5B]=0x24;
to_ascii[0x5C]=0x2A;
to_ascii[0x5D]=0x29;
to_ascii[0x5E]=0x3B;
to_ascii[0x5F]=0x5E;
to_ascii[0x60]=0x2D;
to_ascii[0x61]=0x2F;
to_ascii[0x62]=0xB2;
to_ascii[0x63]=0xB3;
to_ascii[0x64]=0xB4;
to_ascii[0x65]=0xB5;
to_ascii[0x66]=0xB6;
to_ascii[0x67]=0xB7;
to_ascii[0x68]=0xB8;
to_ascii[0x69]=0xB9;
to_ascii[0x6A]=0x7C;
to_ascii[0x6B]=0x2C;
to_ascii[0x6C]=0x25;
to_ascii[0x6D]=0x5F;
to_ascii[0x6E]=0x3E;
to_ascii[0x6F]=0x3F;
to_ascii[0x70]=0xBA;
to_ascii[0x71]=0xBB;
to_ascii[0x72]=0xBC;
to_ascii[0x73]=0xBD;
to_ascii[0x74]=0xBE;
to_ascii[0x75]=0xBF;
to_ascii[0x76]=0xC0;
to_ascii[0x77]=0xC1;
to_ascii[0x78]=0xC2;
to_ascii[0x79]=0x60;
to_ascii[0x7A]=0x3A;
to_ascii[0x7B]=0x23;
to_ascii[0x7C]=0x40;
to_ascii[0x7D]=0x27;
to_ascii[0x7E]=0x3D;
to_ascii[0x7F]=0x22;
to_ascii[0x80]=0xC3;
to_ascii[0x81]=0x61;
to_ascii[0x82]=0x62;
to_ascii[0x83]=0x63;
to_ascii[0x84]=0x64;
to_ascii[0x85]=0x65;
to_ascii[0x86]=0x66;
to_ascii[0x87]=0x67;
to_ascii[0x88]=0x68;
to_ascii[0x89]=0x69;
to_ascii[0x8A]=0xC4;
to_ascii[0x8B]=0xC5;
to_ascii[0x8C]=0xC6;
to_ascii[0x8D]=0xC7;
to_ascii[0x8E]=0xC8;
to_ascii[0x8F]=0xC9;
to_ascii[0x90]=0xCA;
to_ascii[0x91]=0x6A;
to_ascii[0x92]=0x6B;
to_ascii[0x93]=0x6C;
to_ascii[0x94]=0x6D;
to_ascii[0x95]=0x6E;
to_ascii[0x96]=0x6F;
to_ascii[0x97]=0x70;
to_ascii[0x98]=0x71;
to_ascii[0x99]=0x72;
to_ascii[0x9A]=0xCB;
to_ascii[0x9B]=0xCC;
to_ascii[0x9C]=0xCD;
to_ascii[0x9D]=0xCE;
to_ascii[0x9E]=0xCF;
to_ascii[0x9F]=0xD0;
to_ascii[0xA0]=0xD1;
to_ascii[0xA1]=0x7E;
to_ascii[0xA2]=0x73;
to_ascii[0xA3]=0x74;
to_ascii[0xA4]=0x75;
to_ascii[0xA5]=0x76;
to_ascii[0xA6]=0x77;
to_ascii[0xA7]=0x78;
to_ascii[0xA8]=0x79;
to_ascii[0xA9]=0x7A;
to_ascii[0xAA]=0xD2;
to_ascii[0xAB]=0xD3;
to_ascii[0xAC]=0xD4;
to_ascii[0xAD]=0xD5;
to_ascii[0xAE]=0xD6;
to_ascii[0xAF]=0xD7;
to_ascii[0xB0]=0xD8;
to_ascii[0xB1]=0xD9;
to_ascii[0xB2]=0xDA;
to_ascii[0xB3]=0xDB;
to_ascii[0xB4]=0xDC;
to_ascii[0xB5]=0xDD;
to_ascii[0xB6]=0xDE;
to_ascii[0xB7]=0xDF;
to_ascii[0xB8]=0xE0;
to_ascii[0xB9]=0xE1;
to_ascii[0xBA]=0xE2;
to_ascii[0xBB]=0xE3;
to_ascii[0xBC]=0xE4;
to_ascii[0xBD]=0xE5;
to_ascii[0xBE]=0xE6;
to_ascii[0xBF]=0xE7;
to_ascii[0xC0]=0x7B;
to_ascii[0xC1]=0x41;
to_ascii[0xC2]=0x42;
to_ascii[0xC3]=0x43;
to_ascii[0xC4]=0x44;
to_ascii[0xC5]=0x45;
to_ascii[0xC6]=0x46;
to_ascii[0xC7]=0x47;
to_ascii[0xC8]=0x48;
to_ascii[0xC9]=0x49;
to_ascii[0xCA]=0xE8;
to_ascii[0xCB]=0xE9;
to_ascii[0xCC]=0xEA;
to_ascii[0xCD]=0xEB;
to_ascii[0xCE]=0xEC;
to_ascii[0xCF]=0xED;
to_ascii[0xD0]=0x7D;
to_ascii[0xD1]=0x4A;
to_ascii[0xD2]=0x4B;
to_ascii[0xD3]=0x4C;
to_ascii[0xD4]=0x4D;
to_ascii[0xD5]=0x4E;
to_ascii[0xD6]=0x4F;
to_ascii[0xD7]=0x50;
to_ascii[0xD8]=0x51;
to_ascii[0xD9]=0x52;
to_ascii[0xDA]=0xEE;
to_ascii[0xDB]=0xEF;
to_ascii[0xDC]=0xF0;
to_ascii[0xDD]=0xF1;
to_ascii[0xDE]=0xF2;
to_ascii[0xDF]=0xF3;
to_ascii[0xE0]=0x5C;
to_ascii[0xE1]=0x9F;
to_ascii[0xE2]=0x53;
to_ascii[0xE3]=0x54;
to_ascii[0xE4]=0x55;
to_ascii[0xE5]=0x56;
to_ascii[0xE6]=0x57;
to_ascii[0xE7]=0x58;
to_ascii[0xE8]=0x59;
to_ascii[0xE9]=0x5A;
to_ascii[0xEA]=0xF4;
to_ascii[0xEB]=0xF5;
to_ascii[0xEC]=0xF6;
to_ascii[0xED]=0xF7;
to_ascii[0xEE]=0xF8;
to_ascii[0xEF]=0xF9;
to_ascii[0xF0]=0x30;
to_ascii[0xF1]=0x31;
to_ascii[0xF2]=0x32;
to_ascii[0xF3]=0x33;
to_ascii[0xF4]=0x34;
to_ascii[0xF5]=0x35;
to_ascii[0xF6]=0x36;
to_ascii[0xF7]=0x37;
to_ascii[0xF8]=0x38;
to_ascii[0xF9]=0x39;
to_ascii[0xFA]=0xFA;
to_ascii[0xFB]=0xFB;
to_ascii[0xFC]=0xFC;
to_ascii[0xFD]=0xFD;
to_ascii[0xFE]=0xFE;
to_ascii[0xFF]=0xFF;
}

void
ascii_to_ebcdic(unsigned char *ascii,unsigned char *ebcdic,long length)
{
	long i;

	for (i=0;i<length;i++)
	{
		ebcdic[i]=to_ebcdic[ascii[i]];
	}
}

void
ebcdic_to_ascii(unsigned char *ascii,unsigned char *ebcdic,long length)
{
	long i;

	for (i=0;i<length;i++)
	{
		ascii[i]=to_ascii[ebcdic[i]];
	}
}

main()
{
	long i;

	load_tables();

	for (i=0;i<STRING_SIZE;i++)
	{
		ascii[i]=random()%256;
	}

    ascii[0]='T';
    ascii[1]='e';
    ascii[2]='s';
    ascii[3]='t';
    ascii[4]=0;

    printf("before = %s\n",ascii);

	for (i=0;i<ITERATIONS;i++)
	{
		ascii_to_ebcdic(ascii,ebcdic,STRING_SIZE);
		ebcdic_to_ascii(ascii,ebcdic,STRING_SIZE);
	}

    printf("after = %s\n",ascii);
}

